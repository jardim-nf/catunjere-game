/* src/styles/QuestionCard.css - COMPLETO E CORRIGIDO */

/* =========================================
   1. ANIMAÇÕES (Mantidas do original)
   ========================================= */
@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes bounceIn {
  0% { transform: scale(0.3); opacity: 0; }
  50% { transform: scale(1.05); }
  70% { transform: scale(0.9); }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes correctGlow {
  0%, 100% { box-shadow: 0 0 20px rgba(76, 175, 80, 0.5); }
  50% { box-shadow: 0 0 40px rgba(76, 175, 80, 0.8); }
}

@keyframes wrongShake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
  20%, 40%, 60%, 80% { transform: translateX(5px); }
}

@keyframes loadingProgress {
  0% { width: 0%; }
  100% { width: 100%; }
}

@keyframes rotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

@keyframes fireworks {
  0% { transform: translateY(0) scale(0); opacity: 1; }
  100% { transform: translateY(-100px) scale(1); opacity: 0; }
}

@keyframes slideInUp {
  from { transform: translateY(30px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

/* =========================================
   2. ESTRUTURA DO CARD (Cores Corrigidas)
   ========================================= */

.question-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.85); /* Fundo bem escuro atrás */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
  backdrop-filter: blur(5px);
}

.question-card {
  /* FUNDO ESCURO SÓLIDO para garantir leitura */
  background-color: #1a1a2e;
  background: linear-gradient(145deg, #1a1a2e, #16213e);
  border-radius: 20px;
  width: 90%;
  max-width: 800px;
  padding: 30px;
  box-shadow: 
    0 20px 40px rgba(0, 0, 0, 0.5),
    0 0 0 1px rgba(255, 255, 255, 0.1);
  position: relative;
  overflow: hidden;
  border: 2px solid #4ECDC4; /* Borda colorida */
  animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  color: #ffffff; /* Texto base branco */
}

/* Fireworks background */
.fireworks-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 1;
}

.firework {
  position: absolute;
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background: radial-gradient(circle, #ffeb3b, #ff9800, transparent 70%);
  animation: fireworks 1.5s ease-out infinite;
}

.f0 { top: 20%; left: 20%; animation-delay: 0s; }
.f1 { top: 30%; left: 70%; animation-delay: 0.3s; background: radial-gradient(circle, #4caf50, #2196f3, transparent 70%); }
.f2 { top: 60%; left: 40%; animation-delay: 0.6s; background: radial-gradient(circle, #e91e63, #9c27b0, transparent 70%); }
.f3 { top: 40%; left: 60%; animation-delay: 0.9s; }
.f4 { top: 70%; left: 30%; animation-delay: 1.2s; background: radial-gradient(circle, #00bcd4, #009688, transparent 70%); }

/* Header */
.question-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  position: relative;
  z-index: 2;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  padding-bottom: 15px;
}

.question-header h3 {
  color: #ffffff; /* Branco */
  font-size: 1.8rem;
  margin: 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

/* Botões de Controle (Audio/Fechar) */
.audio-btn {
  background: linear-gradient(145deg, #2196f3, #1976d2);
  border: none;
  width: 45px;
  height: 45px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.2rem;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
  box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
}

.audio-btn:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 20px rgba(33, 150, 243, 0.6);
}

.audio-btn.speaking {
  animation: pulse 1s infinite;
  background: linear-gradient(145deg, #ff9800, #f57c00);
}

.close-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 2px solid rgba(255, 255, 255, 0.2);
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.close-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: rotate(90deg);
  color: #ff5252;
}

/* Conteúdo da Pergunta */
.question-content {
  position: relative;
  z-index: 2;
}

.question-text {
  color: #ffffff; /* Branco */
  font-size: 1.3rem;
  line-height: 1.6;
  margin-bottom: 30px;
  padding: 20px;
  background: rgba(0, 0, 0, 0.3); /* Fundo escuro atrás do texto */
  border-radius: 15px;
  border-left: 4px solid #4ECDC4;
  min-height: 80px;
  display: flex;
  align-items: center;
  font-weight: 500;
}

/* =========================================
   3. OPÇÕES DE RESPOSTA
   ========================================= */

.options-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin-bottom: 25px;
}

.option-btn {
  background: rgba(255, 255, 255, 0.08);
  border: 2px solid rgba(255, 255, 255, 0.15);
  border-radius: 15px;
  padding: 20px;
  color: #ffffff; /* Branco */
  font-size: 1.1rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 15px;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
  text-align: left;
}

.option-btn:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.15);
  border-color: #4ECDC4;
  transform: translateY(-2px);
}

.option-btn:disabled {
  cursor: not-allowed;
  opacity: 0.7;
}

.option-btn.selected {
  background: rgba(33, 150, 243, 0.25);
  border-color: #2196f3;
  box-shadow: 0 5px 20px rgba(33, 150, 243, 0.3);
}

.option-btn.pulse {
  animation: pulse 0.3s ease-in-out;
}

.option-btn.checking {
  animation: pulse 1s infinite;
  background: linear-gradient(145deg, rgba(255, 193, 7, 0.2), rgba(255, 152, 0, 0.2));
  border-color: #ff9800;
}

.option-letter {
  background: rgba(255, 255, 255, 0.2);
  width: 35px;
  height: 35px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.1rem;
  color: white;
  flex-shrink: 0;
}

/* Cores das Respostas (Botões) */
.option-btn.correct {
  background: linear-gradient(145deg, rgba(76, 175, 80, 0.4), rgba(56, 142, 60, 0.4));
  border-color: #4caf50;
}

.option-btn.correct-reveal {
  animation: correctGlow 0.8s ease-in-out 3;
}

.option-btn.wrong {
  background: linear-gradient(145deg, rgba(244, 67, 54, 0.4), rgba(198, 40, 40, 0.4));
  border-color: #f44336;
}

.option-btn.wrong-reveal {
  animation: wrongShake 0.5s ease-in-out;
}

/* Ícones de Check/Cross */
.checkmark {
  width: 25px;
  height: 25px;
  border-radius: 50%;
  background: #4caf50;
  position: relative;
  animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  margin-left: auto;
}
.checkmark::before {
  content: ''; position: absolute; top: 50%; left: 50%; width: 8px; height: 13px;
  border: solid white; border-width: 0 3px 3px 0;
  transform: translate(-50%, -60%) rotate(45deg);
}

.cross {
  width: 25px; height: 25px; border-radius: 50%; background: #f44336;
  position: relative; animation: bounceIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  margin-left: auto;
}
.cross::before, .cross::after {
  content: ''; position: absolute; top: 50%; left: 50%; width: 15px; height: 3px;
  background: white; border-radius: 2px;
}
.cross::before { transform: translate(-50%, -50%) rotate(45deg); }
.cross::after { transform: translate(-50%, -50%) rotate(-45deg); }

.correct-glow {
  position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px;
  border-radius: 20px;
  background: radial-gradient(circle at center, rgba(76, 175, 80, 0.3), transparent 70%);
  animation: pulse 2s infinite; pointer-events: none; z-index: -1;
}

/* =========================================
   4. FEEDBACK (CORREÇÃO DE LEGIBILIDADE)
   ========================================= */

/* Loading Bar */
.feedback-loading { margin: 25px 0; text-align: center; }
.loading-bar { width: 100%; height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 3px; overflow: hidden; margin-bottom: 10px; }
.loading-progress { height: 100%; background: linear-gradient(90deg, #2196f3, #00bcd4); animation: loadingProgress 0.8s ease-in-out; border-radius: 3px; }
.loading-text { color: #90caf9; font-size: 0.9rem; animation: pulse 1.5s infinite; }

/* Caixa Principal de Feedback */
.answer-feedback {
  margin-top: 20px;
  padding: 25px;
  border-radius: 15px;
  animation: bounceIn 0.6s;
  background-color: #1a1a2e !important; /* Padrão escuro */
  border: 2px solid rgba(255, 255, 255, 0.1);
  position: relative;
  z-index: 10;
}

/* --- ESTILO DE ACERTO (CORRIGIDO) --- */
.answer-feedback.correct {
  background: linear-gradient(145deg, #1b5e20, #2e7d32) !important; /* Verde Escuro Sólido */
  border: 2px solid #4caf50 !important;
  box-shadow: 0 5px 25px rgba(76, 175, 80, 0.4);
}

/* Texto branco forçado no acerto */
.answer-feedback.correct h4,
.answer-feedback.correct p,
.answer-feedback.correct .success-title,
.answer-feedback.correct .detail-text,
.answer-feedback.correct span {
  color: #ffffff !important;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

/* --- ESTILO DE ERRO (CORRIGIDO) --- */
.answer-feedback.wrong {
  background: linear-gradient(145deg, #b71c1c, #c62828) !important; /* Vermelho Escuro Sólido */
  border: 2px solid #ef5350 !important;
  box-shadow: 0 5px 25px rgba(244, 67, 54, 0.4);
}

/* Texto branco forçado no erro */
.answer-feedback.wrong h4,
.answer-feedback.wrong p,
.answer-feedback.wrong .incorrect-title,
.answer-feedback.wrong .explanation-text,
.answer-feedback.wrong .correct-text,
.answer-feedback.wrong span {
  color: #ffffff !important;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

/* Badges e Elementos Internos do Feedback */
.celebration-header, .incorrect-header {
  display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;
}
.celebration-header h4, .incorrect-header h4 {
  display: flex; align-items: center; gap: 10px; margin: 0; font-size: 1.4rem;
}

.celebrate-icon, .incorrect-icon { font-size: 2rem; }
.celebrate-icon { animation: float 2s ease-in-out infinite; }
.incorrect-icon { animation: shake 0.5s ease-in-out; }

.score-badge {
  background: rgba(0, 0, 0, 0.4) !important;
  color: #4caf50 !important;
  border: 1px solid #4caf50;
  padding: 8px 20px; border-radius: 25px; font-weight: bold;
}

.penalty-badge {
  background: rgba(0, 0, 0, 0.4) !important;
  color: #ff5252 !important;
  border: 1px solid #ff5252;
  padding: 8px 20px; border-radius: 25px; font-weight: bold;
}

.success-details {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;
}
.detail-item {
  display: flex; align-items: center; gap: 10px; padding: 12px;
  background: rgba(0, 0, 0, 0.2); border-radius: 10px;
}

/* Área de explicação do erro */
.correct-option-display {
  display: flex; align-items: center; gap: 15px; padding: 15px;
  background: rgba(0, 0, 0, 0.3); /* Escuro para contraste */
  border-radius: 10px; border-left: 4px solid #4caf50;
  margin-top: 10px;
}
.correct-letter {
  background: #4caf50; color: white; width: 35px; height: 35px;
  border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;
}

.explanation-box {
  background: rgba(0, 0, 0, 0.3); /* Escuro para contraste */
  border: 1px solid #ffc107;
  border-radius: 10px; padding: 15px; margin-top: 20px;
  display: flex; align-items: flex-start; gap: 12px;
}
.explanation-icon { color: #ffc107; font-size: 1.5rem; }

/* Barra de Progresso de Pontos */
.score-progress { margin-top: 25px; }
.progress-bar { width: 100%; height: 10px; background: rgba(0,0,0,0.3); border-radius: 5px; overflow: hidden; margin-bottom: 10px; }
.progress-fill { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); animation: loadingProgress 1s ease-out; border-radius: 5px; }
.progress-text { color: #a5d6a7 !important; font-size: 0.9rem; text-align: center; }

/* Timer */
.next-action-timer { display: flex; flex-direction: column; align-items: center; margin-top: 30px; }
.timer-circle {
  width: 60px; height: 60px; border-radius: 50%;
  background: conic-gradient(#fff, #fff 100%, transparent 100%);
  display: flex; align-items: center; justify-content: center;
  position: relative; animation: rotate 2s linear infinite;
}
.timer-fill { position: absolute; width: 50px; height: 50px; background: #1a1a2e; border-radius: 50%; }
.timer-text { color: #fff; font-weight: bold; font-size: 1.1rem; position: relative; z-index: 2; }
.timer-message { color: #fff; margin-top: 10px; font-size: 0.9rem; animation: pulse 1.5s infinite; }

/* Botão de Enviar */
.question-actions { margin-top: 25px; text-align: center; }
.submit-btn {
  background: linear-gradient(145deg, #2196f3, #1976d2);
  border: none; border-radius: 50px; padding: 18px 40px;
  color: white; font-size: 1.2rem; font-weight: bold;
  cursor: pointer; display: inline-flex; align-items: center; justify-content: center;
  gap: 12px; transition: all 0.3s; min-width: 250px;
  box-shadow: 0 8px 25px rgba(33, 150, 243, 0.4);
}
.submit-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(33, 150, 243, 0.6); }
.submit-btn:disabled { background: linear-gradient(145deg, #666, #444); cursor: not-allowed; box-shadow: none; }
.submit-btn.active { animation: pulse 2s infinite; }

/* Animação Verificando */
.verification-animation { display: flex; flex-direction: column; align-items: center; margin-top: 30px; padding: 30px; }
.verification-spinner {
  width: 60px; height: 60px; border: 5px solid rgba(33, 150, 243, 0.2);
  border-top-color: #2196f3; border-radius: 50%;
  animation: rotate 1s linear infinite; margin-bottom: 20px;
}
.verification-text { color: #90caf9; font-size: 1.1rem; animation: pulse 1.5s infinite; }

/* Responsividade */
@media (max-width: 768px) {
  .options-grid { grid-template-columns: 1fr; }
  .question-card { padding: 20px; margin: 10px; width: 95%; }
  .question-header h3 { font-size: 1.4rem; }
  .success-details { grid-template-columns: 1fr; }
  .submit-btn { width: 100%; min-width: auto; }
}

/* Cascading Animations */
.answer-feedback > * { animation: slideInUp 0.5s ease-out forwards; animation-delay: calc(var(--item-index, 0) * 0.1s); }
.answer-feedback.correct > * { --item-index: 0; }
.answer-feedback.correct > *:nth-child(2) { --item-index: 1; }
.answer-feedback.correct > *:nth-child(3) { --item-index: 2; }
.answer-feedback.correct > *:nth-child(4) { --item-index: 3; }